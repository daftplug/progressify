import{config as n}from"./frontend.js";import{p as e}from"./installPrompt-689ca566.js";import{a,i as t,s as r,g as o}from"./utils-ae07b67a.js";const{__:i}=wp.i18n;class l extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.styles=new Set}connectedCallback(){this.render(),this.handleRemove(),this.handlePerformInstallation()}static show(){let e=document.querySelector("pwa-install-overlay-header-banner");return e||(e=document.createElement("pwa-install-overlay-header-banner"),n.daftplugFrontend.appendChild(e),requestAnimationFrame(()=>{e.shadowRoot.querySelector(".header-banner-overlay").classList.add("visible")})),e}injectStyles(n){this.styles.add(n)}handleRemove(){const n=this.shadowRoot.querySelector(".header-banner-overlay");this.shadowRoot.querySelector(".header-banner-overlay-button_close").addEventListener("click",()=>{n.classList.remove("visible"),setTimeout(()=>this.remove(),300)})}handlePerformInstallation(){this.shadowRoot.querySelector(".header-banner-overlay-button_install").addEventListener("click",()=>{e()})}render(){var e,a,t,r,l;const s=null!=(e=n.jsVars.settings.webAppManifest.appIdentity.appName)?e:"",d=null!=(a=null==(t=n.jsVars.settings.webAppManifest)||null==(t=t.appearance)?void 0:t.themeColor)?a:"#000000",p=o(d),h=null!=(r=null==(l=n.jsVars.settings.installation)||null==(l=l.prompts)?void 0:l.text)?r:i("Install Web App",n.slug),c=n.jsVars.iconUrl?`<img class="header-banner-overlay-appinfo_icon" src="${n.jsVars.iconUrl}" alt="${s}" onerror="this.style.display='none'"></img>`:"";this.injectStyles(`\n      .header-banner-overlay {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        gap: 1rem;\n        position: fixed;\n        top: 0;\n        right: 0;\n        left: 0;\n        z-index: 99999;\n        padding: 0.75rem;\n        background-color: ${d};\n        color: ${p};\n        box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);\n        -webkit-transition: all 0.2s ease-out;\n        -o-transition: all 0.2s ease-out;\n        transition: all 0.2s ease-out;\n        opacity: 0;\n        visibility: hidden;\n      }\n\n      .header-banner-overlay.visible {\n        opacity: 1;\n        visibility: visible;\n      }\n\n      .header-banner-overlay-appinfo {\n        display: -webkit-box;\n        display: -ms-flexbox;\n        display: flex;\n        -webkit-box-align: center;\n            -ms-flex-align: center;\n                align-items: center;\n        gap: 0.75rem;\n      }\n\n      .header-banner-overlay-appinfo_icon {\n        border-radius: 9999px;\n        border: 1px solid #e5e7eb;\n        -ms-flex-negative: 0;\n            flex-shrink: 0;\n        height: 50px;\n        width: 50px;\n        display: inline-block;\n      }\n\n      .header-banner-overlay-appinfo_title {\n        font-size: 0.875rem;\n        line-height: 1.25rem;\n        font-weight: 500;\n        color: ${p};\n        display: -webkit-box;\n        overflow: hidden;\n        -webkit-box-orient: vertical;\n        -webkit-line-clamp: 1;\n      }\n\n      .header-banner-overlay-appinfo_description {\n        font-size: 0.75rem;\n        line-height: 1rem;\n        font-weight: 400;\n        color: ${p}cc;\n        margin-top: 0.12rem;\n        text-wrap: balance;\n        display: -webkit-box;\n        overflow: hidden;\n        -webkit-box-orient: vertical;\n        -webkit-line-clamp: 2;\n      }\n\n      .header-banner-overlay-buttons {\n        display: flex;\n        align-items: center;\n        gap: 0.5rem;\n        flex-shrink: 0;\n      }\n\n      .header-banner-overlay-button_install {\n        display: inline-block;\n        background-color: ${p};\n        color: ${d};\n        vertical-align: middle;\n        text-decoration: none;\n        font-size: 0.875rem;\n        line-height: 1.25rem;\n        font-weight: 600;\n        padding: 0.375rem 0.875rem;\n        border: none;\n        outline: none;\n        border-radius: 9999px;\n        cursor: pointer;\n      }\n\n      .header-banner-overlay-button_install:hover {\n        opacity: 0.8;\n      }\n\n      .header-banner-overlay-button_close {\n        display: inline-flex;\n        background-color: transparent;\n        color: ${p}cc;\n        padding: 0;\n        border-radius: 0.5rem;\n        cursor: pointer;\n        outline: none;\n        border: none;\n      }\n\n      .header-banner-overlay-button_close:hover {\n        background-color: ${p}1a;\n      }\n\n      .header-banner-overlay-button_close svg {\n        width: 1rem;\n        height: 1rem;\n      }\n\n      @media (min-width: 400px) {\n        .header-banner-overlay-appinfo_icon {\n          height: 45px;\n          width: 45px;\n        }\n      }\n\n      @media (min-width: 1200px) {\n        .header-banner-overlay {\n          justify-content: center;\n          gap: 5rem;\n        }\n\n        .header-banner-overlay-button_close {\n          padding: 0.375rem;\n        }\n      }\n    `);const b=Array.from(this.styles).join("\n");this.shadowRoot.innerHTML=`\n      <style>${b}</style>\n      <div class="header-banner-overlay">\n        <div class="header-banner-overlay-appinfo">\n          ${c}\n          <div class="header-banner-overlay-appinfo_texts">\n            <div class="header-banner-overlay-appinfo_title">${h}</div>\n            <div class="header-banner-overlay-appinfo_description">${i("Get our web app. It won't take up space on your device.",n.slug)}</div>\n          </div>\n        </div>\n        <div class="header-banner-overlay-buttons">\n          <button type="button" class="header-banner-overlay-button_install">\n            ${i("Install Now",n.slug)}\n          </button>\n          <button type="button" class="header-banner-overlay-button_close" aria-label="Close">\n            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg>\n          </button>\n        </div>\n      </div>\n    `}}async function s(){var e,o,i;const{platform:s}=n.jsVars.userData,d=s.isBrowser,p=s.isPwa,h=null!=(e=null==(o=n.jsVars.settings.installation)||null==(o=o.prompts)?void 0:o.timeout)?e:1,c="on"===(null==(i=n.jsVars.settings.installation)||null==(i=i.prompts)?void 0:i.skipFirstVisit),b=a("pwa_header_banner_overlay_shown");!d||p||b||c&&!t()||(customElements.get("pwa-install-overlay-header-banner")||customElements.define("pwa-install-overlay-header-banner",l),l.show(),r("pwa_header_banner_overlay_shown","true",h))}export{s as initInstallOverlayHeaderBanner};
