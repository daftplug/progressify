import{config as o}from"./frontend.js";import{p as e}from"./installPrompt-a4fbb5d8.js";import{i as n,g as t}from"./utils-b7f0f688.js";const{__:r}=wp.i18n;class i extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.styles=new Set}connectedCallback(){this.render(),this.handlePerformInstallation()}static findCheckoutForm(){const o=["form.wc-block-checkout__form","form.woocommerce-checkout"];for(const e of o){const o=document.querySelector(e);if(o)return o}return null}static show(){let o=document.querySelector("pwa-install-overlay-woocommerce-checkout");if(!o){const e=this.findCheckoutForm();e&&(o=document.createElement("pwa-install-overlay-woocommerce-checkout"),e.parentNode.insertBefore(o,e.nextSibling))}return o}injectStyles(o){this.styles.add(o)}handlePerformInstallation(){const o=this.shadowRoot.querySelector(".woocommerce-checkout-overlay-button_install");null==o||o.addEventListener("click",()=>{e()})}render(){var e,n,i,s,c;const l=null!=(e=o.jsVars.settings.webAppManifest.appIdentity.appName)?e:"",a=null!=(n=null==(i=o.jsVars.settings.webAppManifest)||null==(i=i.appearance)?void 0:i.themeColor)?n:"#000000",m=t(a),p=null!=(s=null==(c=o.jsVars.settings.installation)||null==(c=c.prompts)?void 0:c.text)?s:r("Install Web App",o.slug),d=o.jsVars.iconUrl?`<img class="woocommerce-checkout-overlay-appinfo_icon" src="${o.jsVars.iconUrl}" alt="${l}" onerror="this.style.display='none'"/>`:"";this.injectStyles(`\n      .woocommerce-checkout-overlay {\n        position: relative;\n        border-radius: 0.5rem;\n        padding: 1rem;\n        margin-top: 2rem;\n        background-color: ${a};\n        color: ${m};\n        box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);\n        -webkit-transition: all 0.2s ease-out;\n        -o-transition: all 0.2s ease-out;\n        transition: all 0.2s ease-out;\n        overflow: hidden;\n        text-transform: none;\n      }\n\n      .woocommerce-checkout-overlay-appinfo {\n        display: flex;\n        align-items: center;\n        gap: 0.75rem;\n        flex: 1;\n      }\n\n      .woocommerce-checkout-overlay-appinfo_icon {\n        border-radius: 9999px;\n        border: 1px solid #e5e7eb;\n        flex-shrink: 0;\n        height: 50px;\n        width: 50px;\n        display: inline-block;\n      }\n\n      .woocommerce-checkout-overlay-appinfo_texts {\n        flex: 1;\n        min-width: 0;\n      }\n\n      .woocommerce-checkout-overlay-appinfo_title {\n        font-size: 0.875rem;\n        line-height: 1.25rem;\n        font-weight: 500;\n        color: ${m};\n        display: -webkit-box;\n        overflow: hidden;\n        -webkit-box-orient: vertical;\n        -webkit-line-clamp: 1;\n      }\n\n      .woocommerce-checkout-overlay-appinfo_description {\n        font-size: 0.75rem;\n        line-height: 1rem;\n        font-weight: 400;\n        color: ${m}cc;\n        margin-top: 0.12rem;\n        display: -webkit-box;\n        overflow: hidden;\n        -webkit-box-orient: vertical;\n        -webkit-line-clamp: 2;\n      }\n\n      .woocommerce-checkout-overlay-button_install {\n        display: block;\n        background-color: ${m};\n        color: ${a};\n        vertical-align: middle;\n        text-decoration: none;\n        font-size: 0.875rem;\n        line-height: 1.25rem;\n        font-weight: 600;\n        padding: 0.375rem 0.875rem;\n        margin-left: auto;\n        margin-top: 1rem;\n        border: none;\n        outline: none;\n        border-radius: 9999px;\n        cursor: pointer;\n      }\n    `);const u=Array.from(this.styles).join("\n");this.shadowRoot.innerHTML=`\n      <style>${u}</style>\n      <div class="woocommerce-checkout-overlay">\n        <div class="woocommerce-checkout-overlay-appinfo">\n          ${d}\n          <div class="woocommerce-checkout-overlay-appinfo_texts">\n            <div class="woocommerce-checkout-overlay-appinfo_title">${p}</div>\n            <div class="woocommerce-checkout-overlay-appinfo_description">${r("Keep track of your orders. Our web app is fast, small and works offline.",o.slug)}</div>\n          </div>\n        </div>\n        <button type="button" class="woocommerce-checkout-overlay-button_install">\n          ${r("Install Now",o.slug)}\n        </button>\n      </div>\n    `}}async function s(){var e,t;const{device:r,platform:s}=o.jsVars.userData,c=r.isSmartphone||r.isTablet,l=s.isBrowser,a=s.isPwa,m="on"===(null==(e=o.jsVars.settings.installation)||null==(e=e.prompts)?void 0:e.skipFirstVisit),p=null==(t=o.jsVars.pluginsData.isActive)?void 0:t.woocommerce,d=document.body.classList.contains("woocommerce-checkout");p&&c&&l&&!a&&d&&(!m||n())&&(customElements.get("pwa-install-overlay-woocommerce-checkout")||customElements.define("pwa-install-overlay-woocommerce-checkout",i),i.show(),setTimeout(()=>{i.show()},1e3))}export{s as initInstallOverlayWoocommerceCheckout};
