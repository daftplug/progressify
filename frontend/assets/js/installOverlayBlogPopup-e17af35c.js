import{config as n}from"./frontend.js";import{p as e}from"./installPrompt-a4fbb5d8.js";import{a as o,b as r,i as s,s as t,g as i}from"./utils-b7f0f688.js";const{__:a}=wp.i18n;class l extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.styles=new Set}connectedCallback(){this.render(),this.handleRemove(),this.handlePerformInstallation()}static show(){let e=document.querySelector("pwa-install-overlay-blog-popup");return e||(e=document.createElement("pwa-install-overlay-blog-popup"),n.daftplugFrontend.appendChild(e),requestAnimationFrame(()=>{const n=e.shadowRoot.querySelector(".blog-popup-overlay");document.documentElement.style.paddingRight=window.innerWidth-document.documentElement.offsetWidth+"px",document.documentElement.style.overflow="hidden",n.classList.add("visible")})),e}injectStyles(n){this.styles.add(n)}handleRemove(){const n=this.shadowRoot.querySelector(".blog-popup-overlay-button.-continue"),e=this.shadowRoot.querySelector(".blog-popup-overlay"),o=()=>{e.classList.remove("visible"),e.addEventListener("transitionend",()=>{document.documentElement.style.removeProperty("overflow"),document.documentElement.style.paddingRight="",this.remove()},{once:!0})};n.addEventListener("click",o),e.addEventListener("click",n=>{n.target===e&&o()})}handlePerformInstallation(){this.shadowRoot.querySelector(".blog-popup-overlay-button.-install").addEventListener("click",()=>{e()})}render(){var e,o,r;const{browser:s}=n.jsVars.userData,t=null!=(e=n.jsVars.settings.webAppManifest.appIdentity.appName)?e:"",l=null!=(o=null==(r=n.jsVars.settings.webAppManifest)||null==(r=r.appearance)?void 0:r.themeColor)?o:"#000000",p=i(l),d=n.jsVars.iconUrl?`<img class="blog-popup-overlay-appinfo_icon" src="${n.jsVars.iconUrl}" alt="${t}" onerror="this.style.display='none'"></img>`:"";let b,c;switch(!0){case s.isChrome:b="Chrome",c=n.jsVars.pluginsData.dirUrl+"/frontend/assets/media/icons/browsers/icon-chrome.png";break;case s.isSafari:b="Safari",c=n.jsVars.pluginsData.dirUrl+"/frontend/assets/media/icons/browsers/icon-safari.png";break;case s.isFirefox:b="Firefox",c=n.jsVars.pluginsData.dirUrl+"/frontend/assets/media/icons/browsers/icon-firefox.png";break;case s.isOpera:b="Opera",c=n.jsVars.pluginsData.dirUrl+"/frontend/assets/media/icons/browsers/icon-opera.png";break;case s.isEdge:b="Edge",c=n.jsVars.pluginsData.dirUrl+"/frontend/assets/media/icons/browsers/icon-edge.png";break;case s.isSamsung:b="Samsung Browser",c=n.jsVars.pluginsData.dirUrl+"/frontend/assets/media/icons/browsers/icon-samsung.png";break;case s.isDuckduckgo:b="DuckDuckGo",c=n.jsVars.pluginsData.dirUrl+"/frontend/assets/media/icons/browsers/icon-duckduckgo.png";break;case s.isBrave:b="Brave",c=n.jsVars.pluginsData.dirUrl+"/frontend/assets/media/icons/browsers/icon-brave.png";break;case s.isQq:b="QQ Browser",c=n.jsVars.pluginsData.dirUrl+"/frontend/assets/media/icons/browsers/icon-qq.png";break;case s.isUc:b="UC Browser",c=n.jsVars.pluginsData.dirUrl+"/frontend/assets/media/icons/browsers/icon-uc.png";break;default:c=n.jsVars.pluginsData.dirUrl+"/frontend/assets/media/icons/browsers/icon-browser.png"}this.injectStyles(`\n      .blog-popup-overlay {\n        position: fixed;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        z-index: 9999999;\n        background: rgba(0, 0, 0, 0);\n        -webkit-backdrop-filter: blur(0px);\n                backdrop-filter: blur(0px);\n        -webkit-transition: all 0.2s ease-out;\n        -o-transition: all 0.2s ease-out;\n        transition: all 0.2s ease-out;\n        opacity: 0;\n        visibility: hidden;\n      }\n\n      .blog-popup-overlay.visible {\n        background: rgba(0, 0, 0, 0.7);\n        -webkit-backdrop-filter: blur(5px);\n                backdrop-filter: blur(5px);\n        opacity: 1;\n        visibility: visible;\n      }\n\n      .blog-popup-overlay-container {\n        position: fixed;\n        width: 100%;\n        bottom: 0;\n        left: 0;\n        background-color: #fff;\n        border-top-left-radius: 1rem;\n        border-top-right-radius: 1rem;\n        border-bottom-left-radius: 0;\n        border-bottom-right-radius: 0;\n        -webkit-transition: all 0.15s ease-out;\n             -o-transition: all 0.15s ease-out;\n                transition: all 0.15s ease-out;\n        z-index: 999999999999999999999;\n        -webkit-transform: translateY(100%);\n            -ms-transform: translateY(100%);\n                transform: translateY(100%);\n      }\n\n      .blog-popup-overlay.visible .blog-popup-overlay-container {\n        -webkit-transform: translateY(0);\n            -ms-transform: translateY(0);\n                transform: translateY(0);\n      }\n\n      .blog-popup-overlay-header {\n        display: -webkit-box;\n        display: -ms-flexbox;\n        display: flex;\n        padding: 0.75rem 1rem;\n        gap: 1.5rem;\n        -webkit-box-pack: center;\n            -ms-flex-pack: center;\n                justify-content: center;\n        -webkit-box-align: center;\n            -ms-flex-align: center;\n                align-items: center;\n        border-bottom: 1px solid #e5e7eb;\n      }\n\n      .blog-popup-overlay-header_title {\n        font-size: 1rem;\n        line-height: 1.5rem;\n        font-weight: 500;\n        color: #1f2937;\n        display: -webkit-box;\n        overflow: hidden;\n        -webkit-box-orient: vertical;\n        -webkit-line-clamp: 1;\n      }\n\n      .blog-popup-overlay-body {\n        display: -webkit-box;\n        display: -ms-flexbox;\n        display: flex;\n        -webkit-box-orient: vertical;\n        -webkit-box-direction: normal;\n            -ms-flex-direction: column;\n                flex-direction: column;\n        gap: 1.25rem;\n        padding: 1.5rem;\n        overflow-y: auto;\n      }\n\n      .blog-popup-overlay-body::-webkit-scrollbar {\n        width: .5rem;\n      }\n\n      .blog-popup-overlay-body::-webkit-scrollbar-thumb {\n        background-color: rgb(209 213 219 / 1);\n        border-radius: 9999px;\n      }\n\n      .blog-popup-overlay-body::-webkit-scrollbar-track {\n        background-color: rgb(243 244 246 / 1);\n      }\n\n      .blog-popup-overlay-appinfo,\n      .blog-popup-overlay-browserinfo {\n        display: -webkit-box;\n        display: -ms-flexbox;\n        display: flex;\n        -webkit-box-pack: justify;\n            -ms-flex-pack: justify;\n                justify-content: space-between;\n        -webkit-box-align: center;\n            -ms-flex-align: center;\n                align-items: center;\n        gap: 1rem;        \n      }\n\n      .blog-popup-overlay-appinfo_media,\n      .blog-popup-overlay-browserinfo_media {\n        display: -webkit-box;\n        display: -ms-flexbox;\n        display: flex;\n        -webkit-box-align: center;\n            -ms-flex-align: center;\n                align-items: center;\n        gap: 0.5rem;\n      }\n\n      .blog-popup-overlay-appinfo_icon,\n      .blog-popup-overlay-browserinfo_icon {\n        border-radius: 9999px;\n        border: 1px solid #e5e7eb;\n        -ms-flex-negative: 0;\n            flex-shrink: 0;\n        height: 48px;\n        width: 48px;\n        display: inline-block;\n      }\n\n      .blog-popup-overlay-appinfo_appname,\n      .blog-popup-overlay-browserinfo_title {\n        font-size: 1rem;\n        line-height: 1.5rem;\n        font-weight: 500;\n        color: #1f2937;\n        display: -webkit-box;\n        overflow: hidden;\n        -webkit-box-orient: vertical;\n        -webkit-line-clamp: 1;\n      }\n\n      .blog-popup-overlay-button {\n        border-radius: 9999px;\n        font-size: 0.875rem;\n        line-height: 1.25rem;\n        font-weight: 700;\n        height: 2.5rem;\n        border: none;\n        outline: none;\n        padding: 0;\n        text-align: center;\n        text-transform: capitalize;\n        width: 6rem;\n      }\n\n      .blog-popup-overlay-button.-install {\n        background-color: ${l};\n        color: ${p};\n      }\n\n      .blog-popup-overlay-button.-continue {\n        background-color: #d9dee2;\n        color: #787c7e;\n        border: 1px solid #d3d6da;\n      }\n    `);const u=Array.from(this.styles).join("\n");this.shadowRoot.innerHTML=`\n      <style>${u}</style>\n      <div class="blog-popup-overlay">\n        <div class="blog-popup-overlay-container">\n          <div class="blog-popup-overlay-header">\n            <div class="blog-popup-overlay-header_title">${a("Read this article in our web app",n.slug)}</div>\n          </div>\n          <div class="blog-popup-overlay-body">\n            <div class="blog-popup-overlay-appinfo">\n              <div class="blog-popup-overlay-appinfo_media">\n                ${d}\n                <div class="blog-popup-overlay-appinfo_appname">${t}</div>\n              </div>\n              <button type="button" class="blog-popup-overlay-button -install">\n                ${a("Open",n.slug)}\n              </button>\n            </div>\n            <div class="blog-popup-overlay-browserinfo">\n              <div class="blog-popup-overlay-browserinfo_media">\n                <img class="blog-popup-overlay-browserinfo_icon" src="${c}" alt="${b}" onerror="this.style.display='none'"></img>\n                <div class="blog-popup-overlay-browserinfo_title">${b}</div>\n              </div>\n              <button type="button" class="blog-popup-overlay-button -continue">\n                ${a("Continue",n.slug)}\n              </button>\n            </div>     \n          </div>\n        </div>\n      </div>\n    `}}async function p(){var e,i,a;let p=!1;const{device:d,platform:b}=n.jsVars.userData,c=d.isSmartphone||d.isTablet,u=b.isBrowser,g=b.isPwa,m=null!=(e=null==(i=n.jsVars.settings.installation)||null==(i=i.prompts)?void 0:i.timeout)?e:1,f="on"===(null==(a=n.jsVars.settings.installation)||null==(a=a.prompts)?void 0:a.skipFirstVisit),v=o("pwa_blog_popup_overlay_shown");!c||!u||g||!r()||v||f&&!s()||(customElements.get("pwa-install-overlay-blog-popup")||customElements.define("pwa-install-overlay-blog-popup",l),window.addEventListener("scroll",()=>{p||window.scrollY/(document.documentElement.scrollHeight-window.innerHeight)*100>=10&&(l.show(),p=!0,t("pwa_blog_popup_overlay_shown","true",m))}))}export{p as initInstallOverlayBlogPopup};
